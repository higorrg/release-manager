<div class="release-detail-container" *ngIf="!isLoading() && release(); else loadingTemplate">
  <!-- Header -->
  <div class="page-header">
    <nz-card>
      <div class="header-content">
        <div class="header-info">
          <div class="breadcrumb">
            <a routerLink="/releases">Releases</a>
            <nz-icon nzType="right" style="margin: 0 8px; color: #8c8c8c;"></nz-icon>
            <span>{{ release()!.product }} v{{ release()!.version }}</span>
          </div>
          <h2>{{ release()!.product }} v{{ release()!.version }}</h2>
          <div class="header-tags">
            <nz-tag [nzColor]="getStatusColor(release()!.status)">
              {{ getStatusText(release()!.status) }}
            </nz-tag>
            <nz-tag [nzColor]="getPriorityColor(release()!.priority)">
              {{ getPriorityText(release()!.priority) }}
            </nz-tag>
          </div>
        </div>
        <div class="header-actions">
          <nz-space>
            <button 
              *nzSpaceItem 
              nz-button 
              nzType="default"
              [routerLink]="['/releases', releaseId(), 'history']">
              <nz-icon nzType="history"></nz-icon>
              Histórico
            </button>
            
            <button 
              *nzSpaceItem 
              nz-button 
              nzType="default"
              [routerLink]="['/releases', releaseId(), 'clients']"
              *ngIf="canManage()">
              <nz-icon nzType="team"></nz-icon>
              Clientes
            </button>
            
            <button 
              *nzSpaceItem 
              nz-button 
              nzType="primary"
              [routerLink]="['/releases', releaseId(), 'edit']"
              *ngIf="canManage()">
              <nz-icon nzType="edit"></nz-icon>
              Editar
            </button>
          </nz-space>
        </div>
      </div>
    </nz-card>
  </div>

  <!-- Release Details -->
  <div class="release-details">
    <nz-card nzTitle="Detalhes do Release">
      <nz-descriptions nzBordered [nzColumn]="2">
        <nz-descriptions-item nzTitle="Produto">
          {{ release()!.product }}
        </nz-descriptions-item>
        
        <nz-descriptions-item nzTitle="Versão">
          <nz-tag nzColor="blue">v{{ release()!.version }}</nz-tag>
        </nz-descriptions-item>
        
        <nz-descriptions-item nzTitle="Status">
          <nz-tag [nzColor]="getStatusColor(release()!.status)">
            {{ getStatusText(release()!.status) }}
          </nz-tag>
        </nz-descriptions-item>
        
        <nz-descriptions-item nzTitle="Prioridade">
          <nz-tag [nzColor]="getPriorityColor(release()!.priority)">
            {{ getPriorityText(release()!.priority) }}
          </nz-tag>
        </nz-descriptions-item>
        
        <nz-descriptions-item nzTitle="Criado em">
          {{ formatDateTime(release()!.createdAt) }}
        </nz-descriptions-item>
        
        <nz-descriptions-item nzTitle="Última atualização">
          {{ formatDateTime(release()!.updatedAt) }}
        </nz-descriptions-item>
        
        <nz-descriptions-item 
          *ngIf="release()!.scheduledDate" 
          nzTitle="Data agendada">
          {{ formatDateTime(release()!.scheduledDate) }}
        </nz-descriptions-item>
        
        <nz-descriptions-item 
          *ngIf="release()!.completedDate" 
          nzTitle="Data de conclusão">
          {{ formatDateTime(release()!.completedDate) }}
        </nz-descriptions-item>
        
        <nz-descriptions-item 
          *ngIf="release()!.totalClients" 
          nzTitle="Total de clientes">
          {{ release()!.totalClients }}
        </nz-descriptions-item>
        
        <nz-descriptions-item 
          *ngIf="release()!.deployedClients !== undefined" 
          nzTitle="Clientes com deploy">
          {{ release()!.deployedClients }}
        </nz-descriptions-item>
      </nz-descriptions>
    </nz-card>
  </div>

  <!-- Release Notes -->
  <div class="release-notes" *ngIf="release()!.releaseNotes">
    <nz-card nzTitle="Notas da Release">
      <div class="notes-content">
        {{ release()!.releaseNotes }}
      </div>
    </nz-card>
  </div>

  <!-- Prerequisites -->
  <div class="prerequisites" *ngIf="release()!.prerequisites">
    <nz-card nzTitle="Pré-requisitos">
      <div class="prerequisites-content">
        {{ release()!.prerequisites }}
      </div>
    </nz-card>
  </div>

  <!-- Tags -->
  <div class="tags" *ngIf="release()!.tags && release()!.tags!.length > 0">
    <nz-card nzTitle="Tags">
      <nz-space nzWrap>
        <nz-tag *ngFor="let tag of release()!.tags" nzColor="default">
          {{ tag }}
        </nz-tag>
      </nz-space>
    </nz-card>
  </div>

  <!-- Quick Actions -->
  <div class="quick-actions">
    <nz-card nzTitle="Ações Rápidas">
      <nz-space nzWrap>
        <button 
          *nzSpaceItem 
          nz-button 
          nzType="default"
          [routerLink]="['/releases', releaseId(), 'history']">
          <nz-icon nzType="history"></nz-icon>
          Ver Histórico
        </button>
        
        <button 
          *nzSpaceItem 
          nz-button 
          nzType="default"
          [routerLink]="['/releases', releaseId(), 'clients']"
          *ngIf="canManage()">
          <nz-icon nzType="team"></nz-icon>
          Gerenciar Clientes
        </button>
        
        <button 
          *nzSpaceItem 
          nz-button 
          nzType="default"
          disabled>
          <nz-icon nzType="upload"></nz-icon>
          Upload de Pacotes
        </button>
        
        <button 
          *nzSpaceItem 
          nz-button 
          nzType="default"
          disabled>
          <nz-icon nzType="download"></nz-icon>
          Download de Pacotes
        </button>
        
        <button 
          *nzSpaceItem 
          nz-button 
          nzType="primary"
          [routerLink]="['/releases', releaseId(), 'edit']"
          *ngIf="canManage()">
          <nz-icon nzType="edit"></nz-icon>
          Editar Release
        </button>
      </nz-space>
    </nz-card>
  </div>
</div>

<!-- Loading Template -->
<ng-template #loadingTemplate>
  <div class="loading-container">
    <nz-spin nzSize="large">
      <div class="loading-content">
        <div style="height: 100px;"></div>
      </div>
    </nz-spin>
  </div>
</ng-template>

<!-- Error State -->
<div class="error-container" *ngIf="!isLoading() && !release()">
  <nz-alert
    nzType="error"
    nzMessage="Release não encontrado"
    nzDescription="O release solicitado não foi encontrado ou você não tem permissão para visualizá-lo."
    nzShowIcon>
  </nz-alert>
  
  <div style="margin-top: 16px; text-align: center;">
    <button nz-button nzType="default" routerLink="/releases">
      <nz-icon nzType="arrow-left"></nz-icon>
      Voltar para Lista
    </button>
  </div>
</div>