<nz-layout class="main-layout">
  <!-- Sidebar -->
  <nz-sider 
    nzCollapsible 
    [(nzCollapsed)]="isCollapsed"
    [nzTrigger]="null"
    nzWidth="250px"
    nzCollapsedWidth="80px"
    class="sidebar">
    
    <!-- Logo -->
    <div class="logo">
      <div class="logo-container">
        <nz-icon 
          *ngIf="isCollapsed()" 
          nzType="rocket" 
          nzTheme="outline"
          class="logo-icon">
        </nz-icon>
        <div *ngIf="!isCollapsed()" class="logo-text">
          <nz-icon nzType="rocket" nzTheme="outline"></nz-icon>
          <span>Release Manager</span>
        </div>
      </div>
    </div>

    <!-- Navigation Menu -->
    <ul nz-menu nzTheme="dark" nzMode="inline" [nzInlineCollapsed]="isCollapsed()">
      <!-- Dashboard -->
      <li nz-menu-item nzMatchRouter>
        <nz-icon nzType="dashboard" nzTheme="outline"></nz-icon>
        <span>Dashboard</span>
        <a routerLink="/dashboard"></a>
      </li>

      <!-- Releases -->
      <li nz-submenu nzTitle="Releases" nzIcon="rocket">
        <ul>
          <li nz-menu-item nzMatchRouter>
            <nz-icon nzType="unordered-list" nzTheme="outline"></nz-icon>
            <span>Lista de Releases</span>
            <a routerLink="/releases"></a>
          </li>
          <li nz-menu-item nzMatchRouter *ngIf="hasManagerAccess()">
            <nz-icon nzType="plus" nzTheme="outline"></nz-icon>
            <span>Novo Release</span>
            <a routerLink="/releases/new"></a>
          </li>
        </ul>
      </li>

      <!-- Clients -->
      <li nz-submenu nzTitle="Clientes" nzIcon="team" *ngIf="hasManagerAccess()">
        <ul>
          <li nz-menu-item nzMatchRouter>
            <nz-icon nzType="user" nzTheme="outline"></nz-icon>
            <span>Lista de Clientes</span>
            <a routerLink="/clients"></a>
          </li>
          <li nz-menu-item nzMatchRouter>
            <nz-icon nzType="user-add" nzTheme="outline"></nz-icon>
            <span>Novo Cliente</span>
            <a routerLink="/clients/new"></a>
          </li>
        </ul>
      </li>

      <!-- Reports -->
      <li nz-menu-item nzMatchRouter *ngIf="hasManagerAccess()">
        <nz-icon nzType="bar-chart" nzTheme="outline"></nz-icon>
        <span>Relatórios</span>
        <a routerLink="/reports"></a>
      </li>

      <!-- Admin -->
      <li nz-submenu nzTitle="Administração" nzIcon="setting" *ngIf="hasAdminAccess()">
        <ul>
          <li nz-menu-item nzMatchRouter>
            <nz-icon nzType="user" nzTheme="outline"></nz-icon>
            <span>Usuários</span>
            <a routerLink="/admin/users"></a>
          </li>
          <li nz-menu-item nzMatchRouter>
            <nz-icon nzType="safety-certificate" nzTheme="outline"></nz-icon>
            <span>Permissões</span>
            <a routerLink="/admin/permissions"></a>
          </li>
        </ul>
      </li>
    </ul>
  </nz-sider>

  <!-- Main Content -->
  <nz-layout class="content-layout">
    <!-- Header -->
    <nz-header class="header">
      <div class="header-content">
        <!-- Menu Toggle -->
        <div class="menu-toggle">
          <button 
            nz-button 
            nzType="text" 
            nzSize="large"
            (click)="toggleSidebar()">
            <nz-icon 
              [nzType]="isCollapsed() ? 'menu-unfold' : 'menu-fold'" 
              nzTheme="outline">
            </nz-icon>
          </button>
        </div>

        <!-- User Menu -->
        <div class="user-menu">
          <nz-dropdown nzPlacement="bottomRight">
            <div nz-dropdown class="user-info">
              <nz-avatar [nzText]="avatarText()" nzSize="small"></nz-avatar>
              <span class="username">{{ userName() }}</span>
              <nz-icon nzType="down" nzTheme="outline"></nz-icon>
            </div>
            <ul nz-menu nz-dropdown>
              <li nz-menu-item (click)="navigateToProfile()">
                <nz-icon nzType="user" nzTheme="outline"></nz-icon>
                Perfil
              </li>
              <li nz-menu-item (click)="navigateToSettings()">
                <nz-icon nzType="setting" nzTheme="outline"></nz-icon>
                Configurações
              </li>
              <li nz-menu-divider></li>
              <li nz-menu-item (click)="logout()">
                <nz-icon nzType="logout" nzTheme="outline"></nz-icon>
                Sair
              </li>
            </ul>
          </nz-dropdown>
        </div>
      </div>
    </nz-header>

    <!-- Content -->
    <nz-content class="main-content">
      <div class="content-area">
        <router-outlet></router-outlet>
      </div>
    </nz-content>

    <!-- Footer -->
    <nz-footer class="footer">
      <div class="footer-content">
        <span>Release Manager © 2024</span>
        <nz-space>
          <span *nzSpaceItem>Versão 1.0.0</span>
          <nz-divider nzType="vertical"></nz-divider>
          <span *nzSpaceItem>
            Usuário: <strong>{{ userName() }}</strong>
          </span>
          <nz-divider nzType="vertical"></nz-divider>
          <span *nzSpaceItem>
            Perfil: <strong>{{ userRole() }}</strong>
          </span>
        </nz-space>
      </div>
    </nz-footer>
  </nz-layout>
</nz-layout>