{"ast":null,"code":"import { inject, signal, computed } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ReleaseService } from '../../core/services/release.service';\nimport * as i0 from \"@angular/core\";\nconst _forTrack0 = ($index, $item) => $item.id;\nfunction ReleaseHistoryComponent_Conditional_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 3)(1, \"p\");\n    i0.ɵɵtext(2, \"Carregando hist\\u00F3rico...\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ReleaseHistoryComponent_Conditional_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 4)(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 6);\n    i0.ɵɵlistener(\"click\", function ReleaseHistoryComponent_Conditional_7_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.loadHistory());\n    });\n    i0.ɵɵtext(4, \"Tentar Novamente\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.error());\n  }\n}\nfunction ReleaseHistoryComponent_Conditional_8_For_2_Conditional_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"span\", 19);\n    i0.ɵɵtext(3, \"\\u2192\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r3 = i0.ɵɵnextContext().$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassMap(ctx_r1.getStatusClass(item_r3.previousStatus));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", item_r3.previousStatusDisplayName, \" \");\n  }\n}\nfunction ReleaseHistoryComponent_Conditional_8_For_2_Conditional_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17)(1, \"strong\");\n    i0.ɵɵtext(2, \"Coment\\u00E1rios:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const item_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(item_r3.comments);\n  }\n}\nfunction ReleaseHistoryComponent_Conditional_8_For_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵelement(1, \"div\", 9);\n    i0.ɵɵelementStart(2, \"div\", 10)(3, \"div\", 11)(4, \"div\", 12);\n    i0.ɵɵtemplate(5, ReleaseHistoryComponent_Conditional_8_For_2_Conditional_5_Template, 4, 3);\n    i0.ɵɵelementStart(6, \"span\", 13);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"div\", 14)(9, \"span\", 15);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"span\", 16);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(13, ReleaseHistoryComponent_Conditional_8_For_2_Conditional_13_Template, 5, 1, \"div\", 17);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const item_r3 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵclassMap(ctx_r1.getStatusTypeClass(item_r3.newStatus));\n    i0.ɵɵadvance(4);\n    i0.ɵɵconditional(item_r3.previousStatus ? 5 : -1);\n    i0.ɵɵadvance();\n    i0.ɵɵclassMap(ctx_r1.getStatusClass(item_r3.newStatus));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", item_r3.newStatusDisplayName, \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r3.changedBy);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.formatDate(item_r3.changedAt));\n    i0.ɵɵadvance();\n    i0.ɵɵconditional(item_r3.comments ? 13 : -1);\n  }\n}\nfunction ReleaseHistoryComponent_Conditional_8_Conditional_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"p\");\n    i0.ɵɵtext(2, \"Nenhum hist\\u00F3rico de mudan\\u00E7as encontrado\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ReleaseHistoryComponent_Conditional_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵrepeaterCreate(1, ReleaseHistoryComponent_Conditional_8_For_2_Template, 14, 9, \"div\", 7, _forTrack0);\n    i0.ɵɵtemplate(3, ReleaseHistoryComponent_Conditional_8_Conditional_3_Template, 3, 0, \"div\", 8);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵrepeater(ctx_r1.history());\n    i0.ɵɵadvance(2);\n    i0.ɵɵconditional(ctx_r1.history().length === 0 ? 3 : -1);\n  }\n}\nexport let ReleaseHistoryComponent = /*#__PURE__*/(() => {\n  class ReleaseHistoryComponent {\n    route = inject(ActivatedRoute);\n    router = inject(Router);\n    releaseService = inject(ReleaseService);\n    history = signal([]);\n    loading = signal(true);\n    error = signal(null);\n    releaseId = computed(() => this.route.snapshot.paramMap.get('id'));\n    ngOnInit() {\n      this.loadHistory();\n    }\n    loadHistory() {\n      const id = this.releaseId();\n      if (!id) {\n        this.error.set('ID da release não encontrado');\n        this.loading.set(false);\n        return;\n      }\n      this.loading.set(true);\n      this.error.set(null);\n      this.releaseService.getReleaseStatusHistory(id).subscribe({\n        next: history => {\n          this.history.set(history);\n          this.loading.set(false);\n        },\n        error: error => {\n          this.error.set('Erro ao carregar histórico: ' + (error.error?.message || error.message));\n          this.loading.set(false);\n        }\n      });\n    }\n    goBack() {\n      const id = this.releaseId();\n      if (id) {\n        this.router.navigate(['/releases', id]);\n      } else {\n        this.router.navigate(['/releases']);\n      }\n    }\n    getStatusClass(status) {\n      const statusMap = {\n        'MR_APROVADO': 'status-mr-aprovado',\n        'PARA_TESTE_SISTEMA': 'status-para-teste',\n        'PARA_TESTE_REGRESSIVO': 'status-para-teste',\n        'APROVADA_TESTE': 'status-aprovada',\n        'APROVADA_TESTE_REGRESSIVO': 'status-aprovada',\n        'REPROVADA_TESTE': 'status-reprovada',\n        'REPROVADA_TESTE_REGRESSIVO': 'status-reprovada',\n        'FALHA_BUILD_TESTE': 'status-falha',\n        'FALHA_BUILD_PRODUCAO': 'status-falha',\n        'FALHA_INSTALACAO_ESTAVEL': 'status-falha',\n        'CONTROLADA': 'status-controlada',\n        'DISPONIVEL': 'status-disponivel',\n        'REVOGADA': 'status-revogada'\n      };\n      return statusMap[status] || 'status-mr-aprovado';\n    }\n    getStatusTypeClass(status) {\n      const successStatuses = ['APROVADA_TESTE', 'APROVADA_TESTE_REGRESSIVO', 'DISPONIVEL'];\n      const errorStatuses = ['REPROVADA_TESTE', 'REPROVADA_TESTE_REGRESSIVO', 'FALHA_BUILD_TESTE', 'FALHA_BUILD_PRODUCAO', 'FALHA_INSTALACAO_ESTAVEL', 'REVOGADA'];\n      const warningStatuses = ['PARA_TESTE_SISTEMA', 'PARA_TESTE_REGRESSIVO'];\n      const infoStatuses = ['MR_APROVADO', 'CONTROLADA'];\n      if (successStatuses.includes(status)) return 'success';\n      if (errorStatuses.includes(status)) return 'error';\n      if (warningStatuses.includes(status)) return 'warning';\n      if (infoStatuses.includes(status)) return 'info';\n      return 'neutral';\n    }\n    formatDate(dateString) {\n      return new Date(dateString).toLocaleString('pt-BR');\n    }\n    static ɵfac = function ReleaseHistoryComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || ReleaseHistoryComponent)();\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ReleaseHistoryComponent,\n      selectors: [[\"app-release-history\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 9,\n      vars: 1,\n      consts: [[1, \"history-container\"], [1, \"header\"], [1, \"btn\", \"btn-secondary\", 3, \"click\"], [1, \"loading\"], [1, \"error-card\"], [1, \"timeline\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"timeline-item\"], [1, \"empty-state\"], [1, \"timeline-marker\"], [1, \"timeline-content\"], [1, \"timeline-header\"], [1, \"status-change\"], [1, \"status-badge\", \"current\"], [1, \"timeline-meta\"], [1, \"changed-by\"], [1, \"changed-at\"], [1, \"timeline-comments\"], [1, \"status-badge\", \"previous\"], [1, \"arrow\"]],\n      template: function ReleaseHistoryComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"button\", 2);\n          i0.ɵɵlistener(\"click\", function ReleaseHistoryComponent_Template_button_click_2_listener() {\n            return ctx.goBack();\n          });\n          i0.ɵɵtext(3, \"\\u2190 Voltar\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"h1\");\n          i0.ɵɵtext(5, \"Hist\\u00F3rico de Mudan\\u00E7as\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(6, ReleaseHistoryComponent_Conditional_6_Template, 3, 0, \"div\", 3)(7, ReleaseHistoryComponent_Conditional_7_Template, 5, 1, \"div\", 4)(8, ReleaseHistoryComponent_Conditional_8_Template, 4, 1, \"div\", 5);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(6);\n          i0.ɵɵconditional(ctx.loading() ? 6 : ctx.error() ? 7 : 8);\n        }\n      },\n      dependencies: [CommonModule],\n      styles: [\".history-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px}.header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-bottom:30px;padding-bottom:20px;border-bottom:1px solid #e1e8ed}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;color:#2c3e50}.btn[_ngcontent-%COMP%]{padding:10px 16px;border:none;border-radius:6px;cursor:pointer;font-size:14px;transition:all .3s;text-decoration:none;display:inline-block}.btn-primary[_ngcontent-%COMP%]{background:#3498db;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#2980b9}.btn-secondary[_ngcontent-%COMP%]{background:#95a5a6;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background:#7f8c8d}.loading[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#7f8c8d}.error-card[_ngcontent-%COMP%]{background:#fff5f5;border:1px solid #fed7d7;color:#e53e3e;padding:20px;border-radius:8px;text-align:center}.timeline[_ngcontent-%COMP%]{position:relative;padding-left:40px}.timeline[_ngcontent-%COMP%]:before{content:\\\"\\\";position:absolute;left:15px;top:0;bottom:0;width:2px;background:#e1e8ed}.timeline-item[_ngcontent-%COMP%]{position:relative;margin-bottom:30px}.timeline-marker[_ngcontent-%COMP%]{position:absolute;left:-32px;top:8px;width:16px;height:16px;border-radius:50%;border:3px solid white;box-shadow:0 0 0 2px #e1e8ed}.timeline-marker.success[_ngcontent-%COMP%]{background:#27ae60;box-shadow:0 0 0 2px #27ae60}.timeline-marker.warning[_ngcontent-%COMP%]{background:#f39c12;box-shadow:0 0 0 2px #f39c12}.timeline-marker.error[_ngcontent-%COMP%]{background:#e74c3c;box-shadow:0 0 0 2px #e74c3c}.timeline-marker.info[_ngcontent-%COMP%]{background:#3498db;box-shadow:0 0 0 2px #3498db}.timeline-marker.neutral[_ngcontent-%COMP%]{background:#95a5a6;box-shadow:0 0 0 2px #95a5a6}.timeline-content[_ngcontent-%COMP%]{background:#fff;border:1px solid #e1e8ed;border-radius:8px;padding:20px}.timeline-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}.status-change[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase}.status-badge.previous[_ngcontent-%COMP%]{opacity:.7}.arrow[_ngcontent-%COMP%]{font-size:16px;color:#6c757d}.status-mr-aprovado[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460}.status-para-teste[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.status-aprovada[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-reprovada[_ngcontent-%COMP%], .status-falha[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.status-controlada[_ngcontent-%COMP%]{background:#e2e3e5;color:#383d41}.status-disponivel[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-revogada[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.timeline-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:4px;font-size:12px;color:#6c757d}.changed-by[_ngcontent-%COMP%]{font-weight:500}.timeline-comments[_ngcontent-%COMP%]{background:#f8f9fa;padding:12px;border-radius:4px;border-left:3px solid #3498db}.timeline-comments[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#2c3e50;font-size:14px}.timeline-comments[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;color:#495057;line-height:1.4}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#7f8c8d}@media (max-width: 768px){.timeline[_ngcontent-%COMP%]{padding-left:30px}.timeline-marker[_ngcontent-%COMP%]{left:-27px;width:12px;height:12px}.timeline-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px;align-items:flex-start}.timeline-meta[_ngcontent-%COMP%]{align-items:flex-start}.status-change[_ngcontent-%COMP%]{flex-wrap:wrap}}\"],\n      changeDetection: 0\n    });\n  }\n  return ReleaseHistoryComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}