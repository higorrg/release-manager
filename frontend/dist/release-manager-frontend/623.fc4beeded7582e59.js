"use strict";(self.webpackChunkrelease_manager_frontend=self.webpackChunkrelease_manager_frontend||[]).push([[623],{6623:(W,f,l)=>{l.r(f),l.d(f,{ClientListComponent:()=>H});var t=l(4438),x=l(177),c=l(4341),P=l(2183),F=l(8359);class k extends F.yU{constructor(i,e){super()}schedule(i,e=0){return this}}const h={setInterval(o,i,...e){const{delegate:n}=h;return n?.setInterval?n.setInterval(o,i,...e):setInterval(o,i,...e)},clearInterval(o){const{delegate:i}=h;return(i?.clearInterval||clearInterval)(o)},delegate:void 0};var M=l(7908);const C={now:()=>(C.delegate||Date).now(),delegate:void 0};class p{constructor(i,e=p.now){this.schedulerActionCtor=i,this.now=e}schedule(i,e=0,n){return new this.schedulerActionCtor(this,i).schedule(n,e)}}p.now=C.now;const j=new class O extends p{constructor(i,e=p.now){super(i,e),this.actions=[],this._active=!1}flush(i){const{actions:e}=this;if(this._active)return void e.push(i);let n;this._active=!0;do{if(n=i.execute(i.state,i.delay))break}while(i=e.shift());if(this._active=!1,n){for(;i=e.shift();)i.unsubscribe();throw n}}}(class y extends k{constructor(i,e){super(i,e),this.scheduler=i,this.work=e,this.pending=!1}schedule(i,e=0){var n;if(this.closed)return this;this.state=i;const s=this.id,r=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(r,s,e)),this.pending=!0,this.delay=e,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(r,this.id,e),this}requestAsyncId(i,e,n=0){return h.setInterval(i.flush.bind(i,this),n)}recycleAsyncId(i,e,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return e;null!=e&&h.clearInterval(e)}execute(i,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(i,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(i,e){let s,n=!1;try{this.work(i)}catch(r){n=!0,s=r||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:i,scheduler:e}=this,{actions:n}=e;this.work=this.state=this.scheduler=null,this.pending=!1,(0,M.o)(n,this),null!=i&&(this.id=this.recycleAsyncId(e,i,null)),this.delay=null,super.unsubscribe()}}});var _=l(9974),b=l(4360),w=l(3669);function R(o,i){return o===i}var m=l(1626),$=l(2825);let A=(()=>{class o{http=(0,t.WQX)(m.Qq);authService=(0,t.WQX)($.u);apiUrl="http://localhost:8081/api/v1/controlled-clients";getHeaders(){const e=this.authService.getAccessToken();return new m.Lr({Authorization:`Bearer ${e}`,"Content-Type":"application/json"})}getAllControlledClients(){return this.http.get(`${this.apiUrl}`,{headers:this.getHeaders()})}getControlledClientsByEnvironment(e){return this.http.get(`${this.apiUrl}?environment=${e}`,{headers:this.getHeaders()})}searchControlledClients(e){return this.http.get(`${this.apiUrl}?search=${e}`,{headers:this.getHeaders()})}static \u0275fac=function(n){return new(n||o)};static \u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();const S=(o,i)=>i.id;function T(o,i){1&o&&(t.j41(0,"div",11),t.EFF(1,"Carregando clientes..."),t.k0s())}function B(o,i){if(1&o){const e=t.RV6();t.j41(0,"div",12)(1,"p"),t.EFF(2),t.k0s(),t.j41(3,"button",14),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.loadClients())}),t.EFF(4,"Tentar Novamente"),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(2),t.JRh(e.error())}}function L(o,i){1&o&&(t.j41(0,"div",13)(1,"p"),t.EFF(2,"Nenhum cliente encontrado."),t.k0s()())}function V(o,i){if(1&o&&(t.j41(0,"span",18),t.EFF(1),t.k0s()),2&o){const e=t.XpG(2);t.R7$(),t.SpI(" ","asc"===e.sortDirection()?"\u25b2":"\u25bc"," ")}}function D(o,i){if(1&o&&(t.j41(0,"span",18),t.EFF(1),t.k0s()),2&o){const e=t.XpG(2);t.R7$(),t.SpI(" ","asc"===e.sortDirection()?"\u25b2":"\u25bc"," ")}}function X(o,i){if(1&o&&(t.j41(0,"span",18),t.EFF(1),t.k0s()),2&o){const e=t.XpG(2);t.R7$(),t.SpI(" ","asc"===e.sortDirection()?"\u25b2":"\u25bc"," ")}}function G(o,i){if(1&o&&(t.j41(0,"span",18),t.EFF(1),t.k0s()),2&o){const e=t.XpG(2);t.R7$(),t.SpI(" ","asc"===e.sortDirection()?"\u25b2":"\u25bc"," ")}}function N(o,i){if(1&o){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td")(4,"span"),t.EFF(5),t.k0s()(),t.j41(6,"td"),t.EFF(7),t.k0s(),t.j41(8,"td"),t.EFF(9),t.k0s(),t.j41(10,"td")(11,"span"),t.EFF(12),t.k0s()(),t.j41(13,"td")(14,"button",24),t.bIt("click",function(){const s=t.eBV(e).$implicit,r=t.XpG(2);return t.Njj(r.viewRelease(s.releaseId))}),t.EFF(15," Ver Release "),t.k0s()()()}if(2&o){const e=i.$implicit,n=t.XpG(2);t.R7$(2),t.JRh(e.clientCode),t.R7$(2),t.HbH("badge-"+e.environment),t.AVh("badge",!0),t.R7$(),t.SpI(" ",e.environment," "),t.R7$(2),t.JRh(e.releaseProduct),t.R7$(2),t.JRh(e.releaseVersion),t.R7$(2),t.HbH("status-"+n.getStatusClass(e.releaseStatus)),t.AVh("status",!0),t.R7$(),t.SpI(" ",e.releaseStatus," ")}}function z(o,i){if(1&o){const e=t.RV6();t.j41(0,"div",15)(1,"table",16)(2,"thead")(3,"tr")(4,"th",17),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.sortBy("clientCode"))}),t.EFF(5," C\xf3digo do Cliente "),t.DNE(6,V,2,1,"span",18),t.k0s(),t.j41(7,"th",17),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.sortBy("environment"))}),t.EFF(8," Ambiente "),t.DNE(9,D,2,1,"span",18),t.k0s(),t.j41(10,"th",17),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.sortBy("releaseProduct"))}),t.EFF(11," Produto "),t.DNE(12,X,2,1,"span",18),t.k0s(),t.j41(13,"th",17),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.sortBy("releaseVersion"))}),t.EFF(14," Vers\xe3o "),t.DNE(15,G,2,1,"span",18),t.k0s(),t.j41(16,"th"),t.EFF(17,"Status da Release"),t.k0s(),t.j41(18,"th"),t.EFF(19,"A\xe7\xf5es"),t.k0s()()(),t.j41(20,"tbody"),t.Z7z(21,N,16,13,"tr",null,S),t.k0s()()(),t.j41(23,"div",19)(24,"div",20),t.EFF(25),t.k0s(),t.j41(26,"div",21)(27,"button",22),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.previousPage())}),t.EFF(28," Anterior "),t.k0s(),t.j41(29,"span",23),t.EFF(30),t.k0s(),t.j41(31,"button",22),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.nextPage())}),t.EFF(32," Pr\xf3xima "),t.k0s()()()}if(2&o){const e=t.XpG();t.R7$(6),t.vxM("clientCode"===e.sortField()?6:-1),t.R7$(3),t.vxM("environment"===e.sortField()?9:-1),t.R7$(3),t.vxM("releaseProduct"===e.sortField()?12:-1),t.R7$(3),t.vxM("releaseVersion"===e.sortField()?15:-1),t.R7$(6),t.Dyx(e.paginatedClients()),t.R7$(4),t.SpI(" Mostrando ",e.paginationInfo()," "),t.R7$(2),t.Y8G("disabled",1===e.currentPage()),t.R7$(3),t.Lme(" P\xe1gina ",e.currentPage()," de ",e.totalPages()," "),t.R7$(),t.Y8G("disabled",e.currentPage()===e.totalPages())}}let H=(()=>{class o{clientService=(0,t.WQX)(A);router=(0,t.WQX)(P.Ix);loading=(0,t.vPA)(!0);error=(0,t.vPA)(null);clients=(0,t.vPA)([]);searchControl=new c.MJ("");environmentFilter=new c.MJ("");currentPage=(0,t.vPA)(1);pageSize=25;sortField=(0,t.vPA)("clientCode");sortDirection=(0,t.vPA)("asc");filteredClients=(0,t.EWP)(()=>{const e=this.searchControl.value?.toLowerCase()||"",n=this.environmentFilter.value||"";return this.clients().filter(s=>(s.clientCode.toLowerCase().includes(e)||s.releaseProduct.toLowerCase().includes(e)||s.releaseVersion.toLowerCase().includes(e))&&(!n||s.environment===n)).sort((s,r)=>{const a=this.sortField(),u="asc"===this.sortDirection()?1:-1,g=s[a],d=r[a];return g<d?-1*u:g>d?1*u:0})});paginatedClients=(0,t.EWP)(()=>{const e=this.filteredClients(),n=(this.currentPage()-1)*this.pageSize;return e.slice(n,n+this.pageSize)});totalPages=(0,t.EWP)(()=>Math.ceil(this.filteredClients().length/this.pageSize));paginationInfo=(0,t.EWP)(()=>{const e=this.filteredClients().length,n=(this.currentPage()-1)*this.pageSize+1;return`${n}-${Math.min(n+this.pageSize-1,e)} de ${e} clientes`});ngOnInit(){this.loadClients(),this.searchControl.valueChanges.pipe(function E(o,i=j){return(0,_.N)((e,n)=>{let s=null,r=null,a=null;const u=()=>{if(s){s.unsubscribe(),s=null;const d=r;r=null,n.next(d)}};function g(){const d=a+o,v=i.now();if(v<d)return s=this.schedule(void 0,d-v),void n.add(s);u()}e.subscribe((0,b._)(n,d=>{r=d,a=i.now(),s||(s=i.schedule(g,o),n.add(s))},()=>{u(),n.complete()},void 0,()=>{r=s=null}))})}(300),function I(o,i=w.D){return o=o??R,(0,_.N)((e,n)=>{let s,r=!0;e.subscribe((0,b._)(n,a=>{const u=i(a);(r||!o(s,u))&&(r=!1,s=u,n.next(a))}))})}()).subscribe(()=>{this.currentPage.set(1)}),this.environmentFilter.valueChanges.subscribe(()=>{this.currentPage.set(1)})}loadClients(){this.loading.set(!0),this.error.set(null),this.clientService.getAllControlledClients().subscribe({next:e=>{this.clients.set(e),this.loading.set(!1)},error:e=>{this.error.set("Erro ao carregar clientes: "+e.message),this.loading.set(!1)}})}sortBy(e){this.sortField()===e?this.sortDirection.set("asc"===this.sortDirection()?"desc":"asc"):(this.sortField.set(e),this.sortDirection.set("asc"))}getStatusClass(e){return e.includes("Aprovad")?"approved":e.includes("Falha")||e.includes("Reprovad")?"failed":e.includes("Dispon\xedvel")?"available":"pending"}viewRelease(e){this.router.navigate(["/releases",e])}nextPage(){this.currentPage()<this.totalPages()&&this.currentPage.set(this.currentPage()+1)}previousPage(){this.currentPage()>1&&this.currentPage.set(this.currentPage()-1)}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=t.VBU({type:o,selectors:[["app-client-list"]],standalone:!0,features:[t.aNF],decls:21,vars:3,consts:[[1,"client-list-container"],[1,"header"],[1,"filters"],[1,"search-box"],["type","text","placeholder","Buscar por c\xf3digo do cliente ou release...",1,"search-input",3,"formControl"],[1,"filter-group"],["for","environment-filter"],["id","environment-filter",1,"filter-select",3,"formControl"],["value",""],["value","homologacao"],["value","producao"],[1,"loading"],[1,"error"],[1,"empty-state"],[1,"btn","btn-primary",3,"click"],[1,"table-container"],[1,"clients-table"],[1,"sortable",3,"click"],[1,"sort-icon"],[1,"pagination"],[1,"pagination-info"],[1,"pagination-controls"],[1,"btn","btn-sm",3,"click","disabled"],[1,"page-number"],[1,"btn","btn-sm","btn-primary",3,"click"]],template:function(n,s){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"h1"),t.EFF(3,"Clientes em Controlado"),t.k0s()(),t.j41(4,"div",2)(5,"div",3),t.nrm(6,"input",4),t.k0s(),t.j41(7,"div",5)(8,"label",6),t.EFF(9,"Ambiente:"),t.k0s(),t.j41(10,"select",7)(11,"option",8),t.EFF(12,"Todos"),t.k0s(),t.j41(13,"option",9),t.EFF(14,"Homologa\xe7\xe3o"),t.k0s(),t.j41(15,"option",10),t.EFF(16,"Produ\xe7\xe3o"),t.k0s()()()(),t.DNE(17,T,2,0,"div",11)(18,B,5,1,"div",12)(19,L,3,0,"div",13)(20,z,33,9),t.k0s()),2&n&&(t.R7$(6),t.Y8G("formControl",s.searchControl),t.R7$(4),t.Y8G("formControl",s.environmentFilter),t.R7$(7),t.vxM(s.loading()?17:s.error()?18:0===s.filteredClients().length?19:20))},dependencies:[x.MD,c.X1,c.xH,c.y7,c.me,c.wz,c.BC,c.l_],styles:[".client-list-container[_ngcontent-%COMP%]{padding:20px;max-width:1400px;margin:0 auto}.header[_ngcontent-%COMP%]{margin-bottom:30px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;color:#333}.filters[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:20px;padding:20px;background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}.search-box[_ngcontent-%COMP%]{flex:1}.search-input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ced4da;border-radius:4px;font-size:14px}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#80bdff;box-shadow:0 0 0 .2rem #007bff40}.filter-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#495057}.filter-select[_ngcontent-%COMP%]{padding:10px;border:1px solid #ced4da;border-radius:4px;font-size:14px;min-width:150px}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px;background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}.error[_ngcontent-%COMP%]{color:#dc3545}.error[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:20px}.table-container[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a;overflow:hidden}.clients-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.clients-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .clients-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:left;border-bottom:1px solid #dee2e6}.clients-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f8f9fa;font-weight:600;color:#495057;-webkit-user-select:none;user-select:none}.clients-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer;position:relative}.clients-table[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background:#e9ecef}.sort-icon[_ngcontent-%COMP%]{margin-left:5px;font-size:12px;color:#007bff}.clients-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f8f9fa}.badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;font-size:12px;font-weight:500;text-transform:uppercase}.badge-homologacao[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.badge-producao[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460}.status[_ngcontent-%COMP%]{padding:4px 12px;border-radius:4px;font-weight:500;display:inline-block;font-size:13px}.status-approved[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-pending[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.status-failed[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.status-available[_ngcontent-%COMP%]{background:#cce5ff;color:#004085}.btn[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:4px;cursor:pointer;font-size:14px;transition:background-color .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:#007bff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#0056b3}.btn-sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:20px;padding:15px 20px;background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}.pagination-info[_ngcontent-%COMP%]{color:#6c757d;font-size:14px}.pagination-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px}.page-number[_ngcontent-%COMP%]{color:#495057;font-weight:500}"],changeDetection:0})}return o})()}}]);