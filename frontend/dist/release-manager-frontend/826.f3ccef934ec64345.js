"use strict";(self.webpackChunkrelease_manager_frontend=self.webpackChunkrelease_manager_frontend||[]).push([[826],{1826:(M,d,i)=>{i.r(d),i.d(d,{ReleaseListComponent:()=>E});var e=i(4438),u=i(177),r=i(4341),_=i(2183),g=i(7225);const m=(a,s)=>s.id;function f(a,s){1&a&&(e.j41(0,"div",11),e.EFF(1,"Nome do produto \xe9 obrigat\xf3rio"),e.k0s())}function C(a,s){1&a&&(e.j41(0,"div",11),e.EFF(1,"Vers\xe3o \xe9 obrigat\xf3ria (formato: x.y.z)"),e.k0s())}function b(a,s){if(1&a){const t=e.RV6();e.j41(0,"div",3)(1,"h3"),e.EFF(2,"Criar Nova Release"),e.k0s(),e.j41(3,"form",7),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.createRelease())}),e.j41(4,"div",8)(5,"label",9),e.EFF(6,"Nome do Produto"),e.k0s(),e.nrm(7,"input",10),e.DNE(8,f,2,0,"div",11),e.k0s(),e.j41(9,"div",8)(10,"label",12),e.EFF(11,"Vers\xe3o"),e.k0s(),e.nrm(12,"input",13),e.DNE(13,C,2,0,"div",11),e.k0s(),e.j41(14,"div",14)(15,"button",15),e.EFF(16),e.k0s(),e.j41(17,"button",16),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.toggleCreateForm())}),e.EFF(18," Cancelar "),e.k0s()()()()}if(2&a){let t,o;const n=e.XpG();e.R7$(3),e.Y8G("formGroup",n.createForm),e.R7$(5),e.vxM(null!=(t=n.createForm.get("productName"))&&t.invalid&&null!=(t=n.createForm.get("productName"))&&t.touched?8:-1),e.R7$(5),e.vxM(null!=(o=n.createForm.get("version"))&&o.invalid&&null!=(o=n.createForm.get("version"))&&o.touched?13:-1),e.R7$(2),e.Y8G("disabled",n.createForm.invalid||n.creating()),e.R7$(),e.SpI(" ",n.creating()?"Criando...":"Criar Release"," ")}}function x(a,s){1&a&&(e.j41(0,"div",4)(1,"p"),e.EFF(2,"Carregando releases..."),e.k0s()())}function v(a,s){if(1&a){const t=e.RV6();e.j41(0,"div",5)(1,"p"),e.EFF(2),e.k0s(),e.j41(3,"button",2),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadReleases())}),e.EFF(4,"Tentar Novamente"),e.k0s()()}if(2&a){const t=e.XpG();e.R7$(2),e.JRh(t.error())}}function F(a,s){if(1&a&&(e.j41(0,"option",24),e.EFF(1),e.k0s()),2&a){const t=s.$implicit,o=e.XpG(3);e.Y8G("value",t),e.R7$(),e.JRh(o.getStatusDisplayName(t))}}function h(a,s){if(1&a){const t=e.RV6();e.j41(0,"div",17)(1,"div",19)(2,"h3"),e.EFF(3),e.k0s(),e.j41(4,"span",20),e.EFF(5),e.k0s()(),e.j41(6,"div",21)(7,"p")(8,"strong"),e.EFF(9,"Criado em:"),e.k0s(),e.EFF(10),e.k0s(),e.j41(11,"p")(12,"strong"),e.EFF(13,"Atualizado em:"),e.k0s(),e.EFF(14),e.k0s()(),e.j41(15,"div",22)(16,"label"),e.EFF(17,"Alterar Status:"),e.k0s(),e.j41(18,"select",23),e.bIt("change",function(n){const l=e.eBV(t).$implicit,c=e.XpG(2);return e.Njj(c.updateStatus(l,n))}),e.Z7z(19,F,2,2,"option",24,e.fX1),e.k0s()(),e.j41(21,"div",25)(22,"button",26),e.bIt("click",function(){const n=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.viewDetails(n.id))}),e.EFF(23," Ver Detalhes "),e.k0s(),e.j41(24,"button",26),e.bIt("click",function(){const n=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.viewHistory(n.id))}),e.EFF(25," Hist\xf3rico "),e.k0s()()()}if(2&a){const t=s.$implicit,o=e.XpG(2);e.R7$(3),e.JRh(t.version),e.R7$(),e.HbH(o.getStatusClass(t.status)),e.R7$(),e.SpI(" ",t.statusDisplayName," "),e.R7$(5),e.SpI(" ",o.formatDate(t.createdAt),""),e.R7$(4),e.SpI(" ",o.formatDate(t.updatedAt),""),e.R7$(4),e.Y8G("value",t.status),e.R7$(),e.Dyx(o.availableStatuses())}}function R(a,s){1&a&&(e.j41(0,"div",18)(1,"p"),e.EFF(2,"Nenhuma release encontrada"),e.k0s(),e.j41(3,"p"),e.EFF(4,'Crie sua primeira release usando o bot\xe3o "Nova Release"'),e.k0s()())}function P(a,s){if(1&a&&(e.j41(0,"div",6),e.Z7z(1,h,26,7,"div",17,m),e.DNE(3,R,5,0,"div",18),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.Dyx(t.releases()),e.R7$(2),e.vxM(0===t.releases().length?3:-1)}}let E=(()=>{class a{releaseService=(0,e.WQX)(g.p);router=(0,e.WQX)(_.Ix);fb=(0,e.WQX)(r.ok);releases=(0,e.vPA)([]);loading=(0,e.vPA)(!0);error=(0,e.vPA)(null);creating=(0,e.vPA)(!1);showCreateForm=(0,e.vPA)(!1);createForm=this.fb.group({productName:["",[r.k0.required]],version:["",[r.k0.required,r.k0.pattern(/^\d+\.\d+\.\d+$/)]]});availableStatuses=(0,e.EWP)(()=>this.releaseService.getAvailableStatuses());ngOnInit(){this.loadReleases()}loadReleases(){this.loading.set(!0),this.error.set(null),setTimeout(()=>{this.releases.set([]),this.loading.set(!1)},1e3)}toggleCreateForm(){this.showCreateForm.update(t=>!t),this.showCreateForm()||this.createForm.reset()}createRelease(){this.createForm.valid&&(this.creating.set(!0),this.releaseService.createReleaseFromPipeline({productName:this.createForm.value.productName,version:this.createForm.value.version}).subscribe({next:o=>{this.releases.update(n=>[o,...n]),this.createForm.reset(),this.showCreateForm.set(!1),this.creating.set(!1)},error:o=>{this.error.set("Erro ao criar release: "+(o.error?.message||o.message)),this.creating.set(!1)}}))}updateStatus(t,o){const n=o.target.value;n!==t.status&&this.releaseService.updateReleaseStatus(t.id,n).subscribe({next:c=>{this.releases.update(O=>O.map(p=>p.id===t.id?c:p))},error:c=>{this.error.set("Erro ao atualizar status: "+(c.error?.message||c.message)),o.target.value=t.status}})}viewDetails(t){this.router.navigate(["/releases",t])}viewHistory(t){this.router.navigate(["/releases",t,"history"])}getStatusDisplayName(t){return t}getStatusClass(t){return{MR_APROVADO:"status-mr-aprovado",PARA_TESTE_SISTEMA:"status-para-teste",PARA_TESTE_REGRESSIVO:"status-para-teste",APROVADA_TESTE:"status-aprovada",APROVADA_TESTE_REGRESSIVO:"status-aprovada",REPROVADA_TESTE:"status-reprovada",REPROVADA_TESTE_REGRESSIVO:"status-reprovada",FALHA_BUILD_TESTE:"status-falha",FALHA_BUILD_PRODUCAO:"status-falha",FALHA_INSTALACAO_ESTAVEL:"status-falha",CONTROLADA:"status-controlada",DISPONIVEL:"status-disponivel",REVOGADA:"status-revogada"}[t]||"status-mr-aprovado"}formatDate(t){return new Date(t).toLocaleString("pt-BR")}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-release-list"]],standalone:!0,features:[e.aNF],decls:10,vars:5,consts:[[1,"release-list-container"],[1,"header"],[1,"btn","btn-primary",3,"click"],[1,"create-form-card"],[1,"loading"],[1,"error-card"],[1,"releases-grid"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","productName"],["id","productName","type","text","formControlName","productName","placeholder","Ex: Plataforma Shift",1,"form-control"],[1,"error-message"],["for","version"],["id","version","type","text","formControlName","version","placeholder","Ex: 1.2.3",1,"form-control"],[1,"form-actions"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"release-card"],[1,"empty-state"],[1,"release-header"],[1,"status-badge"],[1,"release-info"],[1,"status-update"],[1,"status-select",3,"change","value"],[3,"value"],[1,"release-actions"],[1,"btn","btn-outline",3,"click"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"h2"),e.EFF(3,"Gerenciamento de Releases"),e.k0s(),e.j41(4,"button",2),e.bIt("click",function(){return n.toggleCreateForm()}),e.EFF(5),e.k0s()(),e.DNE(6,b,19,5,"div",3)(7,x,3,0,"div",4)(8,v,5,1,"div",5)(9,P,4,1,"div",6),e.k0s()),2&o&&(e.R7$(4),e.AVh("active",n.showCreateForm()),e.R7$(),e.SpI(" ",n.showCreateForm()?"Cancelar":"Nova Release"," "),e.R7$(),e.vxM(n.showCreateForm()?6:-1),e.R7$(),e.vxM(n.loading()?7:n.error()?8:9))},dependencies:[u.MD,r.YN,r.qT,r.xH,r.y7,r.me,r.BC,r.cb,r.X1,r.j4,r.JD],styles:[".release-list-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#2c3e50}.btn[_ngcontent-%COMP%]{padding:10px 16px;border:none;border-radius:6px;cursor:pointer;font-size:14px;transition:all .3s;text-decoration:none;display:inline-block}.btn-primary[_ngcontent-%COMP%]{background:#3498db;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#2980b9}.btn-primary.active[_ngcontent-%COMP%]{background:#e74c3c}.btn-secondary[_ngcontent-%COMP%]{background:#95a5a6;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background:#7f8c8d}.btn-outline[_ngcontent-%COMP%]{background:transparent;color:#3498db;border:1px solid #3498db}.btn-outline[_ngcontent-%COMP%]:hover{background:#3498db;color:#fff}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.create-form-card[_ngcontent-%COMP%]{background:#fff;padding:24px;border-radius:8px;box-shadow:0 2px 8px #0000001a;margin-bottom:30px;border:1px solid #e1e8ed}.create-form-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 20px;color:#2c3e50}.form-group[_ngcontent-%COMP%]{margin-bottom:16px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-weight:500;color:#2c3e50}.form-control[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #ddd;border-radius:4px;font-size:14px;box-sizing:border-box}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#3498db;box-shadow:0 0 0 2px #3498db33}.error-message[_ngcontent-%COMP%]{color:#e74c3c;font-size:12px;margin-top:4px}.form-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:20px}.loading[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#7f8c8d}.error-card[_ngcontent-%COMP%]{background:#fff5f5;border:1px solid #fed7d7;color:#e53e3e;padding:20px;border-radius:8px;text-align:center}.releases-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:20px}.release-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e1e8ed;border-radius:8px;padding:20px;transition:box-shadow .3s}.release-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a}.release-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.release-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#2c3e50}.status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase}.status-mr-aprovado[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460}.status-para-teste[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.status-aprovada[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-reprovada[_ngcontent-%COMP%], .status-falha[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.status-controlada[_ngcontent-%COMP%]{background:#e2e3e5;color:#383d41}.status-disponivel[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-revogada[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.release-info[_ngcontent-%COMP%]{margin-bottom:16px}.release-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;font-size:14px;color:#6c757d}.status-update[_ngcontent-%COMP%]{margin-bottom:16px}.status-update[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px;font-weight:500;color:#2c3e50;font-size:14px}.status-select[_ngcontent-%COMP%]{width:100%;padding:6px 8px;border:1px solid #ddd;border-radius:4px;font-size:13px}.release-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.release-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex:1;text-align:center;font-size:12px;padding:6px 8px}.empty-state[_ngcontent-%COMP%]{grid-column:1 / -1;text-align:center;padding:60px 20px;color:#7f8c8d}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0}"],changeDetection:0})}return a})()}}]);