"use strict";(self.webpackChunkrelease_manager_frontend=self.webpackChunkrelease_manager_frontend||[]).push([[494],{6494:(b,r,s)=>{s.r(r),s.d(r,{ReleaseHistoryComponent:()=>O});var t=s(4438),l=s(177),c=s(2183),p=s(7225);const g=(n,a)=>a.id;function _(n,a){1&n&&(t.j41(0,"div",3)(1,"p"),t.EFF(2,"Carregando hist\xf3rico..."),t.k0s()())}function u(n,a){if(1&n){const e=t.RV6();t.j41(0,"div",4)(1,"p"),t.EFF(2),t.k0s(),t.j41(3,"button",6),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.loadHistory())}),t.EFF(4,"Tentar Novamente"),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(2),t.JRh(e.error())}}function m(n,a){if(1&n&&(t.j41(0,"span",18),t.EFF(1),t.k0s(),t.j41(2,"span",19),t.EFF(3,"\u2192"),t.k0s()),2&n){const e=t.XpG().$implicit,o=t.XpG(2);t.HbH(o.getStatusClass(e.previousStatus)),t.R7$(),t.SpI(" ",e.previousStatusDisplayName," ")}}function f(n,a){if(1&n&&(t.j41(0,"div",17)(1,"strong"),t.EFF(2,"Coment\xe1rios:"),t.k0s(),t.j41(3,"p"),t.EFF(4),t.k0s()()),2&n){const e=t.XpG().$implicit;t.R7$(4),t.JRh(e.comments)}}function x(n,a){if(1&n&&(t.j41(0,"div",7),t.nrm(1,"div",9),t.j41(2,"div",10)(3,"div",11)(4,"div",12),t.DNE(5,m,4,3),t.j41(6,"span",13),t.EFF(7),t.k0s()(),t.j41(8,"div",14)(9,"span",15),t.EFF(10),t.k0s(),t.j41(11,"span",16),t.EFF(12),t.k0s()()(),t.DNE(13,f,5,1,"div",17),t.k0s()()),2&n){const e=a.$implicit,o=t.XpG(2);t.R7$(),t.HbH(o.getStatusTypeClass(e.newStatus)),t.R7$(4),t.vxM(e.previousStatus?5:-1),t.R7$(),t.HbH(o.getStatusClass(e.newStatus)),t.R7$(),t.SpI(" ",e.newStatusDisplayName," "),t.R7$(3),t.JRh(e.changedBy),t.R7$(2),t.JRh(o.formatDate(e.changedAt)),t.R7$(),t.vxM(e.comments?13:-1)}}function C(n,a){1&n&&(t.j41(0,"div",8)(1,"p"),t.EFF(2,"Nenhum hist\xf3rico de mudan\xe7as encontrado"),t.k0s()())}function E(n,a){if(1&n&&(t.j41(0,"div",5),t.Z7z(1,x,14,9,"div",7,g),t.DNE(3,C,3,0,"div",8),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.Dyx(e.history()),t.R7$(2),t.vxM(0===e.history().length?3:-1)}}let O=(()=>{class n{route=(0,t.WQX)(c.nX);router=(0,t.WQX)(c.Ix);releaseService=(0,t.WQX)(p.p);history=(0,t.vPA)([]);loading=(0,t.vPA)(!0);error=(0,t.vPA)(null);releaseId=(0,t.EWP)(()=>this.route.snapshot.paramMap.get("id"));ngOnInit(){this.loadHistory()}loadHistory(){const e=this.releaseId();if(!e)return this.error.set("ID da release n\xe3o encontrado"),void this.loading.set(!1);this.loading.set(!0),this.error.set(null),this.releaseService.getReleaseStatusHistory(e).subscribe({next:o=>{this.history.set(o),this.loading.set(!1)},error:o=>{this.error.set("Erro ao carregar hist\xf3rico: "+(o.error?.message||o.message)),this.loading.set(!1)}})}goBack(){const e=this.releaseId();this.router.navigate(e?["/releases",e]:["/releases"])}getStatusClass(e){return{MR_APROVADO:"status-mr-aprovado",PARA_TESTE_SISTEMA:"status-para-teste",PARA_TESTE_REGRESSIVO:"status-para-teste",APROVADA_TESTE:"status-aprovada",APROVADA_TESTE_REGRESSIVO:"status-aprovada",REPROVADA_TESTE:"status-reprovada",REPROVADA_TESTE_REGRESSIVO:"status-reprovada",FALHA_BUILD_TESTE:"status-falha",FALHA_BUILD_PRODUCAO:"status-falha",FALHA_INSTALACAO_ESTAVEL:"status-falha",CONTROLADA:"status-controlada",DISPONIVEL:"status-disponivel",REVOGADA:"status-revogada"}[e]||"status-mr-aprovado"}getStatusTypeClass(e){return["APROVADA_TESTE","APROVADA_TESTE_REGRESSIVO","DISPONIVEL"].includes(e)?"success":["REPROVADA_TESTE","REPROVADA_TESTE_REGRESSIVO","FALHA_BUILD_TESTE","FALHA_BUILD_PRODUCAO","FALHA_INSTALACAO_ESTAVEL","REVOGADA"].includes(e)?"error":["PARA_TESTE_SISTEMA","PARA_TESTE_REGRESSIVO"].includes(e)?"warning":["MR_APROVADO","CONTROLADA"].includes(e)?"info":"neutral"}formatDate(e){return new Date(e).toLocaleString("pt-BR")}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=t.VBU({type:n,selectors:[["app-release-history"]],standalone:!0,features:[t.aNF],decls:9,vars:1,consts:[[1,"history-container"],[1,"header"],[1,"btn","btn-secondary",3,"click"],[1,"loading"],[1,"error-card"],[1,"timeline"],[1,"btn","btn-primary",3,"click"],[1,"timeline-item"],[1,"empty-state"],[1,"timeline-marker"],[1,"timeline-content"],[1,"timeline-header"],[1,"status-change"],[1,"status-badge","current"],[1,"timeline-meta"],[1,"changed-by"],[1,"changed-at"],[1,"timeline-comments"],[1,"status-badge","previous"],[1,"arrow"]],template:function(o,i){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"button",2),t.bIt("click",function(){return i.goBack()}),t.EFF(3,"\u2190 Voltar"),t.k0s(),t.j41(4,"h1"),t.EFF(5,"Hist\xf3rico de Mudan\xe7as"),t.k0s()(),t.DNE(6,_,3,0,"div",3)(7,u,5,1,"div",4)(8,E,4,1,"div",5),t.k0s()),2&o&&(t.R7$(6),t.vxM(i.loading()?6:i.error()?7:8))},dependencies:[l.MD],styles:['.history-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px}.header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-bottom:30px;padding-bottom:20px;border-bottom:1px solid #e1e8ed}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;color:#2c3e50}.btn[_ngcontent-%COMP%]{padding:10px 16px;border:none;border-radius:6px;cursor:pointer;font-size:14px;transition:all .3s;text-decoration:none;display:inline-block}.btn-primary[_ngcontent-%COMP%]{background:#3498db;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#2980b9}.btn-secondary[_ngcontent-%COMP%]{background:#95a5a6;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background:#7f8c8d}.loading[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#7f8c8d}.error-card[_ngcontent-%COMP%]{background:#fff5f5;border:1px solid #fed7d7;color:#e53e3e;padding:20px;border-radius:8px;text-align:center}.timeline[_ngcontent-%COMP%]{position:relative;padding-left:40px}.timeline[_ngcontent-%COMP%]:before{content:"";position:absolute;left:15px;top:0;bottom:0;width:2px;background:#e1e8ed}.timeline-item[_ngcontent-%COMP%]{position:relative;margin-bottom:30px}.timeline-marker[_ngcontent-%COMP%]{position:absolute;left:-32px;top:8px;width:16px;height:16px;border-radius:50%;border:3px solid white;box-shadow:0 0 0 2px #e1e8ed}.timeline-marker.success[_ngcontent-%COMP%]{background:#27ae60;box-shadow:0 0 0 2px #27ae60}.timeline-marker.warning[_ngcontent-%COMP%]{background:#f39c12;box-shadow:0 0 0 2px #f39c12}.timeline-marker.error[_ngcontent-%COMP%]{background:#e74c3c;box-shadow:0 0 0 2px #e74c3c}.timeline-marker.info[_ngcontent-%COMP%]{background:#3498db;box-shadow:0 0 0 2px #3498db}.timeline-marker.neutral[_ngcontent-%COMP%]{background:#95a5a6;box-shadow:0 0 0 2px #95a5a6}.timeline-content[_ngcontent-%COMP%]{background:#fff;border:1px solid #e1e8ed;border-radius:8px;padding:20px}.timeline-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}.status-change[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase}.status-badge.previous[_ngcontent-%COMP%]{opacity:.7}.arrow[_ngcontent-%COMP%]{font-size:16px;color:#6c757d}.status-mr-aprovado[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460}.status-para-teste[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.status-aprovada[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-reprovada[_ngcontent-%COMP%], .status-falha[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.status-controlada[_ngcontent-%COMP%]{background:#e2e3e5;color:#383d41}.status-disponivel[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-revogada[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.timeline-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:4px;font-size:12px;color:#6c757d}.changed-by[_ngcontent-%COMP%]{font-weight:500}.timeline-comments[_ngcontent-%COMP%]{background:#f8f9fa;padding:12px;border-radius:4px;border-left:3px solid #3498db}.timeline-comments[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#2c3e50;font-size:14px}.timeline-comments[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;color:#495057;line-height:1.4}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#7f8c8d}@media (max-width: 768px){.timeline[_ngcontent-%COMP%]{padding-left:30px}.timeline-marker[_ngcontent-%COMP%]{left:-27px;width:12px;height:12px}.timeline-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px;align-items:flex-start}.timeline-meta[_ngcontent-%COMP%]{align-items:flex-start}.status-change[_ngcontent-%COMP%]{flex-wrap:wrap}}'],changeDetection:0})}return n})()}}]);